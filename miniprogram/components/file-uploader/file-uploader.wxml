<view class="file-uploader {{compact ? 'compact' : ''}}">
  <view class="uploader-label">
    <text class="label-text">{{label}}</text>
    <text class="required" wx:if="{{required}}">*</text>
  </view>

  <view class="uploader-content">
    <view class="file-preview" wx:if="{{fileUrl}}">
      <image wx:if="{{previewUrl}}" class="preview-image" src="{{previewUrl}}" mode="aspectFill" bindtap="previewImage"></image>
      <view wx:else class="preview-empty" bindtap="previewImage">附件不可直显，点击查看</view>
      <view class="preview-mask" wx:if="{{previewUrl}}"></view>
      <view class="preview-actions">
        <button class="btn-reupload" size="mini" bindtap="chooseFile">替换</button>
        <button class="btn-delete" size="mini" bindtap="deleteFile">移除</button>
      </view>
    </view>

    <view class="upload-btn tap-feedback" wx:else bindtap="chooseFile">
      <view class="upload-icon">
        <view class="icon-plus-h"></view>
        <view class="icon-plus-v"></view>
      </view>
      <view class="upload-text">点击上传</view>
      <view class="upload-hint">JPG/PNG，最大 10MB</view>
    </view>

    <view class="upload-progress" wx:if="{{uploading}}">
      <progress percent="{{progress}}" stroke-width="4" activeColor="#2f6af5" />
      <text class="progress-text">上传中 {{progress}}%</text>
    </view>
  </view>

  <view class="error-message" wx:if="{{error}}">{{error}}</view>
</view>
