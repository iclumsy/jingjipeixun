<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>特种作业人员学员信息采集系统</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="container">
        <header>
            <div style="display: flex; align-items: center; gap: 20px;">
                <img src="/static/images/logo.jpg" alt="Logo" style="height: 60px; width: auto;">
                <div>
                    <h1>特种作业人员学员信息采集系统</h1>
                    <p>阳泉精技特种作业人员培训有限公司</p>
                </div>
            </div>
        </header>

        <form id="collectionForm">
            <div id="students-container">
                <!-- Student Entry Template will be injected here -->
            </div>

            <div class="actions">
                <button type="button" id="addStudentBtn" class="btn secondary">+ 添加学员</button>
                <button type="submit" id="submitBtn" class="btn primary">提交所有信息</button>
            </div>
        </form>
    </div>

    <!-- Template for a student entry -->
    <template id="student-template">
        <div class="student-entry">
            <div class="entry-header">
                <h3>学员信息</h3>
                <button type="button" class="btn-delete" onclick="removeStudent(this)">×</button>
            </div>
            <div class="form-grid">
                <div class="form-group w-xs">
                    <label>姓名</label>
                    <span class="hint-slot"></span>
                    <input type="text" name="name" required>
                </div>
                <div class="form-group w-xs">
                    <label>性别</label>
                    <span class="hint-slot"></span>
                    <select name="gender" required>
                        <option value="男">男</option>
                        <option value="女">女</option>
                    </select>
                </div>
                <div class="form-group w-sm">
                    <label>文化程度</label>
                    <span class="hint-slot"></span>
                    <select name="education" required>
                        <option value="">请选择</option>
                        <option value="研究生及以上">研究生及以上</option>
                        <option value="本科或同等学历">本科或同等学历</option>
                        <option value="专科或同等学历">专科或同等学历</option>
                        <option value="中专或同等学历">中专或同等学历</option>
                        <option value="高中或同等学历">高中或同等学历</option>
                        <option value="初中">初中</option>
                    </select>
                </div>
                <div class="form-group w-lg">
                    <label>身份证号</label>
                    <span class="hint-slot"></span>
                    <input type="text" name="id_card" required pattern="\d{17}[\dXx]" title="请输入正确的18位身份证号">
                </div>
                <div class="form-group w-md">
                    <label>手机号</label>
                    <span class="hint-slot"></span>
                    <input type="tel" name="phone" required pattern="\d{11}" title="请输入11位手机号">
                </div>
                <div class="form-group w-md">
                    <label>毕业院校</label>
                    <span class="hint-slot"></span>
                    <input type="text" name="school">
                </div>
                <div class="form-group w-md">
                    <label>所学专业</label>
                    <span class="hint-slot"></span>
                    <input type="text" name="major">
                </div>
                <div class="form-group w-lg">
                    <label>单位名称</label>
                    <span class="hint-slot"></span>
                    <input type="text" name="company">
                </div>
                <div class="form-group w-md">
                    <label>作业类别</label>
                    <span class="hint-slot"></span>
                    <select name="job_category" id="job_category" required onchange="updateExamProjectOptions(this)">
                        <option value="">请选择</option>
                        <option value="电工作业">电工作业</option>
                        <option value="焊接与热切割作业">焊接与热切割作业</option>
                        <option value="高处作业">高处作业</option>
                    </select>
                </div>
                <div class="form-group w-md">
                    <label>操作项目</label>
                    <span class="hint-slot"></span>
                    <select name="exam_project" id="exam_project" required>
                        <option value="">请先选择作业类别</option>
                    </select>
                </div>
                <div class="form-group w-sm">
                    <label>项目代码</label>
                    <span class="hint-slot"></span>
                    <input type="text" name="exam_code">
                </div>
                <div class="form-group w-sm">
                    <label>考试类别</label>
                    <span class="hint-slot"></span>
                    <select name="exam_category" required>
                        <option value="初次领证">初次领证</option>
                        <option value="复审">复审</option>
                        <option value="延期换证">延期换证</option>
                    </select>
                </div>
                <div class="form-group w-full">
                    <label>单位地址</label>
                    <span class="hint-slot"></span>
                    <input type="text" name="company_address">
                </div>
                
                <!-- File Uploads Integrated -->
                <div class="form-group w-upload">
                    <div class="upload-box" onclick="this.querySelector('input').click()">
                        <div class="upload-placeholder">
                            <span class="icon">+</span>
                            <span class="text">个人照片</span>
                        </div>
                        <img class="preview-img" style="display: none;">
                        <input type="file" name="photo" accept="image/*" required title="请上传个人照片" onchange="previewFile(this)">
                    </div>
                </div>
                <div class="form-group w-upload">
                    <div class="upload-box" onclick="this.querySelector('input').click()">
                        <div class="upload-placeholder">
                            <span class="icon">+</span>
                            <span class="text">学历证书</span>
                        </div>
                        <img class="preview-img" style="display: none;">
                        <input type="file" name="diploma" accept="image/*" onchange="previewFile(this)">
                    </div>
                </div>
                <div class="form-group w-upload">
                    <div class="upload-box" onclick="this.querySelector('input').click()">
                        <div class="upload-placeholder">
                            <span class="icon">+</span>
                            <span class="text">所持证件正面</span>
                        </div>
                        <img class="preview-img" style="display: none;">
                        <input type="file" name="cert_front" accept="image/*" onchange="previewFile(this)">
                    </div>
                </div>
                <div class="form-group w-upload">
                    <div class="upload-box" onclick="this.querySelector('input').click()">
                        <div class="upload-placeholder">
                            <span class="icon">+</span>
                            <span class="text">所持证件反面</span>
                        </div>
                        <img class="preview-img" style="display: none;">
                        <input type="file" name="cert_back" accept="image/*" onchange="previewFile(this)">
                    </div>
                </div>
                <div class="form-group w-upload">
                    <div class="upload-box" onclick="this.querySelector('input').click()">
                        <div class="upload-placeholder">
                            <span class="icon">+</span>
                            <span class="text">身份证正面</span>
                        </div>
                        <img class="preview-img" style="display: none;">
                        <input type="file" name="id_card_front" accept="image/*" required title="请上传身份证正面" onchange="previewFile(this)">
                    </div>
                </div>
                <div class="form-group w-upload">
                    <div class="upload-box" onclick="this.querySelector('input').click()">
                        <div class="upload-placeholder">
                            <span class="icon">+</span>
                            <span class="text">身份证反面</span>
                        </div>
                        <img class="preview-img" style="display: none;">
                        <input type="file" name="id_card_back" accept="image/*" required title="请上传身份证反面" onchange="previewFile(this)">
                    </div>
                </div>
            </div>

        </div>
    </template>

    <script src="/static/js/script.js"></script>
    <script>
        // 二级联动下拉选项数据
        const examProjectOptions = {
            '电工作业': [
                { value: '低压电工作业', text: '低压电工作业' },
                { value: '高压电工作业', text: '高压电工作业' },
                { value: '电力电缆作业', text: '电力电缆作业' },
                { value: '电气试验作业', text: '电气试验作业' },
                { value: '继电保护作业', text: '继电保护作业' },
                { value: '防爆电气作业', text: '防爆电气作业' }
            ],
            '焊接与热切割作业': [
                { value: '熔化焊接与热切割作业', text: '熔化焊接与热切割作业' }
            ],
            '高处作业': [
                { value: '高处安装、维护、拆除作业', text: '高处安装、维护、拆除作业' },
                { value: '登高架设作业', text: '登高架设作业' }
            ]
        };

        function updateExamProjectOptions(categorySelect) {
            const projectSelect = document.getElementById('exam_project');
            const selectedCategory = categorySelect.value;
            
            // 清空操作项目下拉选项
            projectSelect.innerHTML = '<option value="">请选择操作项目</option>';
            
            if (selectedCategory && examProjectOptions[selectedCategory]) {
                // 添加对应的操作项目选项
                examProjectOptions[selectedCategory].forEach(option => {
                    const optionElement = document.createElement('option');
                    optionElement.value = option.value;
                    optionElement.textContent = option.text;
                    projectSelect.appendChild(optionElement);
                });
            }
        }
    </script>
</body>
</html>
