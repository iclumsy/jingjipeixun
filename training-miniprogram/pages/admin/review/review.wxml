<view class="page">
  <view class="filter-card card">
    <view class="filter-group">
      <view class="group-title">审核状态</view>
      <view class="chip-list">
        <view
          wx:for="{{statusFilters}}"
          wx:key="value"
          class="chip {{filters.status === item.value ? 'active' : ''}}"
          bindtap="onStatusFilterTap"
          data-value="{{item.value}}"
        >
          {{item.label}}
        </view>
      </view>
    </view>

    <view class="filter-group">
      <view class="group-title">培训类型</view>
      <view class="chip-list">
        <view
          wx:for="{{trainingTypeFilters}}"
          wx:key="value"
          class="chip {{filters.training_type === item.value ? 'active' : ''}}"
          bindtap="onTrainingTypeFilterTap"
          data-value="{{item.value}}"
        >
          {{item.label}}
        </view>
      </view>
    </view>

    <view class="filter-group">
      <view class="group-title">公司</view>
      <picker mode="selector" range="{{companyOptions}}" value="{{companyIndex}}" bindchange="onCompanyChange">
        <view class="picker-value">{{companyOptions[companyIndex] || '全部'}}</view>
      </picker>
    </view>
  </view>

  <view class="record-list">
    <view
      wx:for="{{records}}"
      wx:key="_id"
      class="record-card card"
      bindtap="openDetail"
      data-id="{{item._id}}"
    >
      <view class="record-header">
        <view class="submitter">提交人：{{item.name || '-'}}</view>
        <view class="status-tag status-{{item.status}}">{{item.statusText}}</view>
      </view>

      <view class="record-meta">培训类型：{{item.trainingTypeText}}</view>
      <view class="record-meta">公司：{{item.company || '-'}}</view>
      <view class="record-meta">提交时间：{{item.submitTimeText}}</view>

      <view class="record-actions">
        <button
          class="action-btn btn-sync"
          size="mini"
          catchtap="onSyncTap"
          data-id="{{item._id}}"
        >同步网页端</button>
        <button
          class="action-btn btn-delete"
          size="mini"
          catchtap="onDeleteTap"
          data-id="{{item._id}}"
        >删除记录</button>
        <button
          class="action-btn btn-approve {{item.status !== 'unreviewed' ? 'disabled' : ''}}"
          size="mini"
          catchtap="onApproveTap"
          data-id="{{item._id}}"
          data-status="{{item.status}}"
          disabled="{{item.status !== 'unreviewed'}}"
        >审核通过</button>
        <button
          class="action-btn btn-reject {{item.status !== 'unreviewed' ? 'disabled' : ''}}"
          size="mini"
          catchtap="onRejectTap"
          data-id="{{item._id}}"
          data-status="{{item.status}}"
          disabled="{{item.status !== 'unreviewed'}}"
        >驳回</button>
      </view>
    </view>

    <view class="loading" wx:if="{{loading && !refreshing}}">加载中...</view>
    <view class="no-more" wx:if="{{!loading && !hasMore && records.length > 0}}">没有更多记录了</view>

    <view class="empty" wx:if="{{!loading && records.length === 0}}">
      <view class="empty-text">暂无符合条件的审核记录</view>
    </view>
  </view>
</view>
