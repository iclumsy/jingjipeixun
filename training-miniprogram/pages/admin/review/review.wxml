<view class="page">
  <view class="filter-card card">
    <view class="filter-group">
      <view class="filter-inline">
        <view class="group-title">审核状态</view>
        <view class="chip-list">
          <view
            wx:for="{{statusFilters}}"
            wx:key="value"
            class="filter-chip {{filters.status === item.value ? 'active' : ''}}"
            bindtap="onStatusFilterTap"
            data-value="{{item.value}}"
          >
            {{item.label}}
          </view>
        </view>
      </view>
    </view>

    <view class="filter-group">
      <view class="filter-inline">
        <view class="group-title">培训类型</view>
        <view class="chip-list">
          <view
            wx:for="{{trainingTypeFilters}}"
            wx:key="value"
            class="filter-chip {{filters.training_type === item.value ? 'active' : ''}}"
            bindtap="onTrainingTypeFilterTap"
            data-value="{{item.value}}"
          >
            {{item.label}}
          </view>
        </view>
      </view>
    </view>

    <view class="filter-group">
      <view class="filter-inline">
        <view class="group-title">公司</view>
        <view class="picker-wrap">
          <picker mode="selector" range="{{companyOptions}}" value="{{companyIndex}}" bindchange="onCompanyChange">
            <view class="picker-value">{{companyOptions[companyIndex] || '全部'}}</view>
          </picker>
        </view>
      </view>
    </view>
  </view>

  <view class="record-list">
    <view
      wx:for="{{records}}"
      wx:key="_id"
      class="record-card"
      bindtap="openDetail"
      data-id="{{item._id}}"
    >
      <view class="card-top">
        <view class="name-wrap">
          <view class="student-name">{{item.name || '-'}}</view>
          <view class="time-mini">{{item.submitTimeText}}</view>
        </view>
        <view class="status-badge badge-{{item.status}}">{{item.statusText}}</view>
      </view>

      <view class="meta-chips">
        <view class="meta-chip">{{item.trainingTypeText}}</view>
        <view class="meta-chip">{{item.job_category || '-'}}</view>
      </view>

      <view class="info-list">
        <view class="info-line">
          <text class="info-label">单位</text>
          <text class="info-value">{{item.company || '-'}}</text>
        </view>
        <view class="info-line">
          <text class="info-label">证件</text>
          <text class="info-value">{{item.id_card || '-'}}</text>
        </view>
        <view class="info-line">
          <text class="info-label">手机</text>
          <text class="info-value">{{item.phone || '-'}}</text>
        </view>
      </view>

      <view class="record-actions">
        <button
          class="action-btn btn-approve {{item.status !== 'unreviewed' ? 'disabled' : ''}}"
          size="mini"
          catchtap="onApproveTap"
          data-id="{{item._id}}"
          data-status="{{item.status}}"
          disabled="{{item.status !== 'unreviewed'}}"
        >审核通过</button>
        <button
          class="action-btn btn-reject {{item.status !== 'unreviewed' ? 'disabled' : ''}}"
          size="mini"
          catchtap="onRejectTap"
          data-id="{{item._id}}"
          data-status="{{item.status}}"
          disabled="{{item.status !== 'unreviewed'}}"
        >驳回</button>
        <button
          class="action-btn btn-delete"
          size="mini"
          catchtap="onDeleteTap"
          data-id="{{item._id}}"
        >删除</button>
      </view>
    </view>

    <view class="loading" wx:if="{{loading && !refreshing}}">加载中...</view>
    <view class="no-more" wx:if="{{!loading && !hasMore && records.length > 0}}">没有更多记录了</view>

    <view class="empty" wx:if="{{!loading && records.length === 0}}">
      <view class="empty-text">暂无符合条件的审核记录</view>
    </view>
  </view>
</view>
